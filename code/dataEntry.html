<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Management - Spending & Income</title>
    <script>
        (function() {
            const theme = localStorage.getItem('theme');
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>
    <link rel="stylesheet" href="style/mainStyle.css">
    <link rel="stylesheet" href="style/dataEntryStyle.css">
</head>
<body>
    <!-- Inner Window-->
    <div class="container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="logo-container">
                <div class="logo-oval">
                    <img src="pic/logo_lightmode_vertical_s.png" alt="Logo" width="145" height="50">
                </div>
            </div>
            <div class="top-controls">
                <button class="icon-btn" id="themeToggle" title="Toggle Dark Mode">
                    <span class="theme-icon sun">‚òÄÔ∏è</span>
                    <span class="theme-icon moon">üåô</span>
                </button>
                <button class="icon-btn" id="settingsBtn" title="Settings">
                    <span class="settings-icon">‚öôÔ∏è</span>
                </button>
                <button class="icon-btn" id="profileBtn" title="Profile">
                    <span class="profile-icon">üë§</span>
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Sidebar Navigation -->
            <div class="sidebar">
                <nav class="nav-menu">
                    <a href="main.html" class="nav-item" data-page="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span class="nav-text">Dashboard</span>
                    </a>
                    <a href="dataEntry.html" class="nav-item active" data-page="spending">
                        <span class="nav-icon">üí∞</span>
                        <span class="nav-text">Spending<br>Income</span>
                    </a>
                    <a href="charts.html" class="nav-item" data-page="charts">
                        <span class="nav-icon">üìà</span>
                        <span class="nav-text">Chart</span>
                    </a>
                    <a href="goals.html" class="nav-item" data-page="goals">
                        <span class="nav-icon">üéØ</span>
                        <span class="nav-text">Goals</span>
                    </a>
                </nav>
                
                <!-- Logout Button -->
                <button class="nav-item logout-btn" id="logoutBtn">
                    <span class="nav-icon">üö™</span>
                    <span class="nav-text">Log Out</span>
                </button>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Calendar View (Step 1) -->
                <div id="calendarView" class="view-section active">
                    <div class="calendar-header">
                        <button class="year-btn" id="yearBtn">2025</button>
                        <div class="calendar-navigation">
                            <button class="nav-arrow" id="prevMonth">‚óÄ</button>
                            <button class="month-btn" id="monthBtn">October</button>
                            <button class="nav-arrow" id="nextMonth">‚ñ∂</button>
                        </div>
                        <button class="csv-import-btn">CSV Import</button>
                    </div>
                    
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Year Selection View -->
                <div id="yearView" class="view-section">
                    <h2 class="selection-title">Select Year</h2>
                    <div class="year-grid" id="yearGrid">
                        <!-- Years will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Month Selection View -->
                <div id="monthView" class="view-section">
                    <div class="month-view-header">
                        <button class="year-btn" id="monthViewYearBtn">2025</button>
                        <h2 class="selection-title">Select Month</h2>
                    </div>
                    <div class="month-grid" id="monthGrid">
                        <!-- Months will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Day Records Popup -->
                <div id="dayRecordsModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="modalDate">01/10/2025</h3>
                            <button class="close-btn" id="closeModal">‚úñ</button>
                        </div>
                        <div class="modal-body">
                            <h4>Record</h4>
                            <div id="dayRecordsList" class="day-records-list">
                                <!-- Records will be populated here -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="add-transaction-btn" id="addNewTransactionBtn">Add New Transaction</button>
                        </div>
                    </div>
                </div>

                <!-- Data Entry View (Step 3) -->
                <div id="dataEntryView" class="view-section">
                    <div class="data-entry-header">
                        <button id="backToCalendar">‚Üê Back to Calendar</button>
                        <h1 class="page-title">Spending & Income Tracker</h1>
                    </div>
                    
                    <div class="data-entry-container">
                        <!-- Transaction Type Toggle -->
                        <div class="type-toggle">
                            <button class="type-btn active" data-type="expense">Expense</button>
                            <button class="type-btn" data-type="income">Income</button>
                        </div>

                        <!-- Entry Form -->
                        <div class="entry-form">
                            <div class="form-group">
                                <label for="amount">Amount <span class="required-mark">*</span></label>
                                <div class="input-wrapper">
                                    <input type="number" id="amount" placeholder="0.00" step="0.01" min="0">
                                    <span class="validation-icon"></span>
                                </div>
                                <small class="hint" id="amountHint">Please enter a positive number</small>
                            </div>

                            <div class="form-group">
                                <label for="category">Category <span class="required-mark">*</span></label>
                                <div class="input-wrapper">
                                    <select id="category">
                                        <option value="">Select category</option>
                                        <!-- Expense categories -->
                                        <optgroup label="Expense Categories" id="expenseCategories">
                                            <option value="food">üçî Food & Dining</option>
                                            <option value="transport">üöó Transportation</option>
                                            <option value="shopping">üõçÔ∏è Shopping</option>
                                            <option value="bills">üìÑ Bills & Utilities</option>
                                            <option value="entertainment">üé¨ Entertainment</option>
                                            <option value="health">üè• Health</option>
                                            <option value="other">üì¶ Other</option>
                                        </optgroup>
                                        <!-- Income categories (hidden by default) -->
                                        <optgroup label="Income Categories" id="incomeCategories" style="display: none;">
                                            <option value="salary">üíº Salary</option>
                                            <option value="freelance">üíª Freelance</option>
                                            <option value="investment">üìà Investment</option>
                                            <option value="gift">üéÅ Gift</option>
                                            <option value="other-income">üíµ Other</option>
                                        </optgroup>
                                    </select>
                                    <span class="validation-icon"></span>
                                </div>
                                <small class="hint" id="categoryHint">Please select a category</small>
                            </div>

                            <div class="form-group">
                                <label for="date">Date</label>
                                <input type="date" id="date">
                            </div>

                            <div class="form-group">
                                <label for="description">Description</label>
                                <input type="text" id="description" placeholder="Optional note...">
                            </div>

                            <button class="submit-btn" id="addTransactionBtn">Add Transaction</button>
                        </div>

                        <!-- Recent Transactions -->
                        <div class="transactions-list">
                            <h2>Recent Transactions</h2>
                            <div id="transactionsList">
                                <p class="empty-state">No transactions yet. Add your first transaction above!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="customConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this transaction?</p>
            </div>
            <div class="modal-footer">
                <button id="confirmCancelBtn">Cancel</button>
                <button id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>
    
    <!-- CSV Import Modal -->
    <div id="csvImportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì• CSV Import Guidelines</h3>
                <button class="close-btn" id="closeCsvModal">‚úñ</button>
            </div>
            <div class="modal-body">
                <div>
                    <h4>CSV File Format</h4>
                    <p>
                        Your CSV file should use semicolons (;) as separators with the following structure:
                    </p>
                    <div class="csv-format-example">
                        <code>
                            type;amount;category;DD/MM/YYYY;description
                        </code>
                    </div>
                </div>

                <div>
                    <h4>Field Definitions</h4>
                    <ul class="csv-field-list">
                        <li><strong>type:</strong> expense or income</li>
                        <li><strong>amount:</strong> positive number (e.g., 100.50)</li>
                        <li><strong>category:</strong> food, transport, shopping, bills, entertainment, health, salary, freelance, investment, gift, or other</li>
                        <li><strong>date:</strong> DD/MM/YYYY format (e.g., 28/10/2025)</li>
                        <li><strong>description:</strong> optional text (can be empty)</li>
                    </ul>
                </div>

                <div>
                    <h4>Examples</h4>
                    <div class="csv-examples-box">
                        expense;100.9;food;28/10/2025;Lunch at restaurant<br>
                        income;10000;salary;28/10/2025;<br>
                        expense;45.50;transport;27/10/2025;Taxi to office
                    </div>
                </div>

                <div class="csv-warning-box">
                    <p>
                        <strong>‚ö†Ô∏è Note:</strong> If a category doesn't match the defined categories, it will be automatically changed to "Other" and noted in the description.
                    </p>
                </div>

                <input type="file" id="csvFileInput" accept=".csv">
                <button id="selectCsvBtn">
                    Select CSV File
                </button>
            </div>
        </div>
    </div>

    <!-- CSV Import Result Modal -->
    <div id="csvResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="csvResultTitle">Import Results</h3>
                <button class="close-btn" id="closeCsvResultModal">‚úñ</button>
            </div>
            <div class="modal-body">
                <div id="csvResultContent"></div>
            </div>
            <div class="modal-footer">
                <button id="csvResultOkBtn">
                    OK
                </button>
            </div>
        </div>
    </div>

    <script src="function/main.js"></script>
    <script src="function/dataEntry.js"></script>
</body>
</html>